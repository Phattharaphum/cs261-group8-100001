<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>รายการคำร้อง</title>
    <link rel="stylesheet" href="css/stylesidebar.css">
    <link rel="stylesheet" href="css/styleITStaffPetitions.css">
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Bai+Jamjuree:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;1,200;1,300;1,400;1,500;1,600;1,700&display=swap"
      rel="stylesheet"
    />
    <script defer src="./js/redirect-handler.js"></script>
    <style>
      .tab-button {
        padding: 10px 20px;
        border-radius: 15px;
        border: none;
        cursor: pointer;
        font-weight: bold;
        margin-right: 10px;
      }
      .tab-button.active {
        background-color: white;
        color: black;
      }
      .tab-button.inactive {
        background-color: #d9d9d9;
        color: #333;
      }
      .status-label {
        padding: 5px 10px;
        border-radius: 15px;
        color: white;
        font-weight: bold;
      }

      .status-waiting {
        background-color: #ffe6a7;
        color: #b68900;
      }
      .status-read {
        background-color: #e0b0ff;
        color: #8e44ad;
      }
      .status-rejected {
        background-color: #ffcdd2;
        color: #c62828;
      }
      .status-approved {
        background-color: #a5d6a7;
        color: #2e7d32;
      }
      .status-canceled {
        background-color: #bbdefb;
        color: #1565c0;
      }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sidebar Section -->
        <div class="sidebar">
            <div class="sidebar-header">
              <img src="img/logo.svg" alt="University Logo" class="logo" />
              <div class="tops">
                <p class="hasd">ระบบสำหรับเจ้าหน้าที่</p>
                <p class="asdasd">
                  คณะวิทยาศาสตร์และเทคโนโลยี<br />มหาวิทยาลัยธรรมศาสตร์
                </p>
              </div>
            </div>
            <nav class="sidebar-menu">
              <a href="/ITStaffPetitions.html" class="menu-item active">
                <img src="img/Artboard 1.svg" alt="Petitions Icon" />
                <span class="tee">รายการคำร้อง</span>
              </a>
              <a href="/manage_staff.html" class="menu-item">
                <img src="img/Artboard 1.svg" alt="Edit Staff Icon" />
                <span class="tee">แก้ไขข้อมูลบุคลากรคณะ</span>
              </a>
              <a href="/ITStaffSystemLogs.html" class="menu-item ">
                <img src="img/Artboard 1.svg" alt="Logs Icon" />
                <span class="tee">ประวัติการใช้ระบบ</span>
              </a>
            </nav>
            <div class="logout-section">
              <a href="/logout" class="menu-item">
                <img src="img/Artboard 3.svg" alt="Logout Icon" />
                <span class="tee">ออกจากระบบ</span>
              </a>
              <div class="user-info">
                <div class="asee">
                  <img src="img/avt (1).svg" alt="User Icon" />
                </div>
                <div class="user-details">
                  <p class="name" id="barname">ธนา สงวนวิชา</p>
                  <p class="idd" id="barid">0001</p>
                </div>
              </div>
            </div>
          </div>

        <!-- Main Content Section -->
        <div class="scallable">
          <div class="container">
            <div class="header">
              <div class="header-button">รายการคำร้อง</div>
            </div>
        </div>
        <div class="sss">
          <div class="tab">
            <div class="tab">
              <button
                id="pendingButton"
                class="tab-button active"
                
              >
                ยังไม่ได้ตรวจสอบ
              </button>
              <button
                id="reviewedButton"
                class="tab-button inactive"
                
              >
                ตรวจสอบแล้ว
              </button>
            </div>
          </div>
          <div class="search-filter">
            <input type="text" placeholder="ค้นหา" id="searchInput" />
          </div>
      </div>
      <table class="table">
        <thead>
          <tr class="table-header">
            <th 
              class="column-type coan" 
              
            >
              ประเภท
              <span class="sort-icon" id="sort-icon-petition_type">▲▼</span>
            </th>
            <th
              class="column-subject-name coan"
              
            >
              ชื่อวิชา
              <span class="sort-icon" id="sort-icon-subject_name">▲▼</span>
            </th>
            <th
              class="column-subject-code coan"
              
            >
              รหัสวิชา
              <span class="sort-icon" id="sort-icon-subject_code">▲▼</span>
            </th>
            <th class="column-section">กลุ่มเรียน</th>
            <th class="column-date coan" onclick="sortTable('submit_time')">
              วันที่
              <span class="sort-icon" id="sort-icon-submit_time">▲▼</span>
            </th>
            <th class="column-time">เวลา</th>
            <th class="column-status coan" onclick="sortTable('status')">
              สถานะ <span class="sort-icon" id="sort-icon-status">▲▼</span>
            </th>
            <th class="column-check"></th>
          </tr>
        </thead>

        <tbody id="petition-list"> 
          <tr class="table-row">
            <td class="column-petition-type">ลาออก</td>
            <td class="column-subject-name">English</td>
            <td class="column-subject-code">EL105</td>
            <td class="column-section">01002</td>
            <td class="column-date">11/11/2567</td>
            <td class="column-time">10:00</td>
            <td class="column-status"><span class="status-label status-waiting">ตรวจสอบ</span></td>
            <td class="column-check"><button class="verify-button">ตรวจสอบ</button></td>
          </tr>
        </tboy>

    <!-- <script>
        document.addEventListener('DOMContentLoaded', () => {
            fetch('/api/petitions')
                .then(response => {
                    if (!response.ok) throw new Error(`Failed to fetch petitions: ${response.status}`);
                    return response.json();
                })
                .then(data => {
                    const tableBody = document.getElementById('petitionsTable').querySelector('tbody');
                    tableBody.innerHTML = data.length
                        ? data.map(petition => `
                            <tr>
                                <td>${petition.student_id}</td>
                                <td>${petition.student_name}</td>
                                <td>${getPetitionType(petition.petition_type)}</td>
                                <td>${petition.subject_code || 'N/A'}</td>
                                <td>${getStatusText(petition.status)}</td>
                                <td><button onclick="viewDetails(${petition.petition_id})">ดูรายละเอียด</button></td>
                            </tr>
                        `).join('')
                        : '<tr><td colspan="6">ไม่มีคำร้อง</td></tr>';
                })
                .catch(error => {
                    console.error('Error fetching petitions:', error);
                    document.getElementById('petitionsTable').querySelector('tbody').innerHTML =
                        '<tr><td colspan="6">เกิดข้อผิดพลาดในการโหลดข้อมูล</td></tr>';
                });
        });

        function viewDetails(petitionId) {
            window.location.href = `/ITStaffPetitionDetails.html?id=${petitionId}`;
        }

        function getPetitionType(type) {
            switch (type) {
                case 1: return 'จดทะเบียนล่าช้า';
                case 2: return 'ถอนรายวิชา';
                case 3: return 'เปลี่ยนกลุ่มเรียน';
                default: return 'ประเภทไม่ทราบ';
            }
        }

        function getStatusText(status) {
            switch (status) {
                case 1: return 'รอดำเนินการ';
                case 2: return 'กำลังตรวจสอบ';
                case 3: return 'อนุมัติ';
                case 4: return 'ปฏิเสธ';
                case 5: return 'ยกเลิก';
                default: return 'สถานะไม่ทราบ';
            }
        }
    </script> -->
</body>
</html>
